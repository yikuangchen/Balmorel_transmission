
EQUATIONS
 QFBNEX(ACNETWORKS,Y,RRR,S,T)                         'Find net exchange for each hub in FB simulation'
 QFBLIM(ACNETWORKS,Y,LINES,S,T)                     'PTDF Constraints for each Line'
 QFBLIMRAM(ACNETWORKS,Y,LINES,S,T)
;


QFBNEX(ACNETWORKS,IY411,IR,IS3,T)$AC2RRR(ACNETWORKS,IR)..

        VFBNEX(IY411,IR,IS3,T)

        =E=
          + SUM(IRI$IXK_AC(ACNETWORKS,IRI,IR), VX_AC_T(IY411,IRI,IR,IS3,T)*(1-XLOSS(IRI,IR)))
          -SUM(IRE$IXK_AC(ACNETWORKS,IR,IRE),VX_AC_T(IY411,IR,IRE,IS3,T))
           ;

QFBLIM(ACNETWORKS,IY411,LINES,IS3,T)$AC2LINES(LINES,ACNETWORKS) ..

        SUM(IR$AC2RRR(ACNETWORKS,IR),FB_ACPTDF(ACNETWORKS,LINES,IR)*VFBNEX(IY411,IR,IS3,T))
        =L=
         FB_ACRAM(ACNETWORKS,LINES)
                ;


QFBLIMRAM(ACNETWORKS,IY411,LINES,IS3,T)$AC2LINES(LINES,ACNETWORKS) ..

         SUM((IRE,IRI)$(LINESRRR(LINES,IRE,IRI) OR LINESRRRAC(LINES,IRI,IRE)),VX_AC_T(IY411,IRE,IRI,IS3,T))
         =L=
         FB_ACRAM(ACNETWORKS,LINES)$(IY411.val>2019)+0
;
